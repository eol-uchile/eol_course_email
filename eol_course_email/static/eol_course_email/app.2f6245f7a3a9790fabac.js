(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{196:function(e){e.exports=JSON.parse("{}")},197:function(e){e.exports=JSON.parse("{}")},198:function(e){e.exports=JSON.parse("{}")},199:function(e){e.exports=JSON.parse("{}")},200:function(e){e.exports=JSON.parse("{}")},201:function(e){e.exports=JSON.parse("{}")},202:function(e){e.exports=JSON.parse("{}")},203:function(e){e.exports=JSON.parse("{}")},204:function(e){e.exports=JSON.parse("{}")},205:function(e){e.exports=JSON.parse("{}")},206:function(e){e.exports=JSON.parse("{}")},207:function(e){e.exports=JSON.parse("{}")},208:function(e){e.exports=JSON.parse("{}")},219:function(e,t){},466:function(e,t,r){},474:function(e,t){},480:function(e,t){},501:function(e,t,r){"use strict";r.r(t);r(253);var a=r(17),n=r(22),o=r(237),c=r(515),s=r(235),i=r(0),l=r.n(i),u=r(31),m=r.n(u),d=r(196),f=r(197),p={ar:d,"es-419":r(198),fr:r(199),"zh-cn":r(200),ca:f,he:r(201),id:r(202),"ko-kr":r(203),pl:r(204),"pt-br":r(205),ru:r(206),th:r(207),uk:r(208)},v=r(66),b=r(52),h=r(1),E=r.n(h),y=r(108),g=r(512),w=r(42),x=r(102),N=r(209),j=r(210);function O(e,t,r,a,n,o,c){try{var s=e[o](c),i=s.value}catch(e){return void r(e)}s.done?t(i):Promise.resolve(i).then(a,n)}var S=function(){var e,t=(e=regeneratorRuntime.mark((function e(t){var r,a,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="/courses/".concat(t,"/course_emails/user_email"),e.next=3,fetch(r,{credentials:"same-origin"});case 3:if(200!=(a=e.sent).status){e.next=11;break}return e.next=7,a.json();case 7:return n=e.sent,e.abrupt("return",n);case 11:return e.abrupt("return",[]);case 12:case"end":return e.stop()}}),e)})),function(){var t=this,r=arguments;return new Promise((function(a,n){var o=e.apply(t,r);function c(e){O(o,a,n,c,s,"next",e)}function s(e){O(o,a,n,c,s,"throw",e)}c(void 0)}))});return function(e){return t.apply(this,arguments)}}();function I(e,t,r,a,n,o,c){try{var s=e[o](c),i=s.value}catch(e){return void r(e)}s.done?t(i):Promise.resolve(i).then(a,n)}var _=function(){var e,t=(e=regeneratorRuntime.mark((function e(t){var r,a,n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="/courses/".concat(t,"/course_emails/users"),e.next=3,fetch(r,{credentials:"same-origin"});case 3:if(200!=(a=e.sent).status){e.next=12;break}return e.next=7,a.json();case 7:return n=e.sent,o=n.map((function(e){return{username:e.username,name:e.profile__name,has_role:e.has_role}})),e.abrupt("return",o);case 12:return e.abrupt("return",[]);case 13:case"end":return e.stop()}}),e)})),function(){var t=this,r=arguments;return new Promise((function(a,n){var o=e.apply(t,r);function c(e){I(o,a,n,c,s,"next",e)}function s(e){I(o,a,n,c,s,"throw",e)}c(void 0)}))});return function(e){return t.apply(this,arguments)}}();function k(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e))&&"[object Arguments]"!==Object.prototype.toString.call(e))return;var r=[],a=!0,n=!1,o=void 0;try{for(var c,s=e[Symbol.iterator]();!(a=(c=s.next()).done)&&(r.push(c.value),!t||r.length!==t);a=!0);}catch(e){n=!0,o=e}finally{try{a||null==s.return||s.return()}finally{if(n)throw o}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var R=[];function A(e){var t=function(e){var t=k(Object(i.useState)({email:"",loading:!0}),2),r=t[0],a=t[1];return Object(i.useEffect)((function(){S(e).then((function(e){a({email:e,loading:!1})}))}),[]),r}(e.courseId),r=t.email,a=t.loading;return l.a.createElement("div",{className:"my-2"},l.a.createElement("div",{className:"d-flex justify-content-center text-muted small"},a&&l.a.createElement(g.a,{animation:"border",variant:"primary",className:"mx-auto mt-2 "}),!a&&l.a.createElement("p",null,"El correo electrónico que tienes registrado en la plataforma es ",l.a.createElement("strong",{className:"text-uppercase"},r)," ",l.a.createElement("i",null,"(",l.a.createElement("a",{href:"/account/settings",target:"_parent"},"Actualizar correo"),")"))),l.a.createElement("div",{className:"d-flex"},l.a.createElement(v.b,{to:"/eol/eol_course_email/static/received/"},l.a.createElement(y.a,{variant:"outline-primary shadow-sm",size:"sm"},l.a.createElement(w.a,{icon:N.faArrowDown,className:"mr-2"}),"Recibidos")),l.a.createElement(v.b,{to:"/eol/eol_course_email/static/sended/",className:"mr-auto"},l.a.createElement(y.a,{variant:"outline-primary shadow-sm",size:"sm",className:"mx-3"},l.a.createElement(w.a,{icon:j.faArrowUp,className:"mr-2"}),"Enviados")),l.a.createElement(v.b,{to:"/eol/eol_course_email/static/new/"},l.a.createElement(y.a,{variant:"primary shadow-sm",size:"sm"},l.a.createElement(w.a,{icon:x.faPaperPlane,className:"mr-2"}),"Nuevo Correo"))))}A.propTypes={courseId:E.a.string.isRequired};var C=r(68);function P(e,t,r,a,n,o,c){try{var s=e[o](c),i=s.value}catch(e){return void r(e)}s.done?t(i):Promise.resolve(i).then(a,n)}var T=function(){var e,t=(e=regeneratorRuntime.mark((function e(t){var r,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="/courses/".concat(t.courseId,"/course_emails/send"),e.next=3,Object(C.e)().post(r,t,"json").then((function(e){return{status:201==e.status,status_text:"success"}})).catch((function(e){var t;return{status:!1,status_text:L(null===(t=e.customAttributes)||void 0===t?void 0:t.httpErrorStatus)}}));case 3:return a=e.sent,e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)})),function(){var t=this,r=arguments;return new Promise((function(a,n){var o=e.apply(t,r);function c(e){P(o,a,n,c,s,"next",e)}function s(e){P(o,a,n,c,s,"throw",e)}c(void 0)}))});return function(e){return t.apply(this,arguments)}}(),L=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:400;switch(e){case 403:return"ratelimit";default:return"fail"}};function D(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function J(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function q(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?J(Object(r),!0).forEach((function(t){z(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):J(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function z(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function G(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e))&&"[object Arguments]"!==Object.prototype.toString.call(e))return;var r=[],a=!0,n=!1,o=void 0;try{for(var c,s=e[Symbol.iterator]();!(a=(c=s.next()).done)&&(r.push(c.value),!t||r.length!==t);a=!0);}catch(e){n=!0,o=e}finally{try{a||null==s.return||s.return()}finally{if(n)throw o}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var M=r(517),B=r(213),F=r(516),H=function(e){switch(e.status){case"pending":return l.a.createElement(g.a,{animation:"border",variant:"primary",className:"d-flex mx-auto mt-2 "});case"ratelimit":return l.a.createElement(F.a,{variant:"danger",className:"mx-4 mt-3 text-center w-100 shadow"},"Error al enviar correo. ",l.a.createElement("strong",null,"Has superado el límite de correos por minuto y deberás esperar un momento para volver enviar correos."));case"fail":return l.a.createElement(F.a,{variant:"danger",className:"mx-4 mt-3 text-center w-100 shadow"},"Error al enviar correo. Intentar nuevamente.");case"success":return l.a.createElement(F.a,{variant:"success",className:"mx-4 mt-3 text-center w-100 shadow"},l.a.createElement("strong",null,"Tu mensaje fue procesado con éxito para ser enviado"),".",l.a.createElement("br",null),"Los destinatarios comenzarán a recibir el correo en los próximos minutos.");case"empty-list":return l.a.createElement(F.a,{variant:"warning",className:"mx-4 mt-3 text-center w-100 shadow"},l.a.createElement("strong",null,"Debes seleccionar al menos un destinatario."));default:return l.a.createElement(l.a.Fragment,null)}};function W(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e))&&"[object Arguments]"!==Object.prototype.toString.call(e))return;var r=[],a=!0,n=!1,o=void 0;try{for(var c,s=e[Symbol.iterator]();!(a=(c=s.next()).done)&&(r.push(c.value),!t||r.length!==t);a=!0);}catch(e){n=!0,o=e}finally{try{a||null==s.return||s.return()}finally{if(n)throw o}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}H.propTypes={status:E.a.string.isRequired};var $=function(e){var t=e.courseId,r=function(e){var t=k(Object(i.useState)({users:[],loading:!0}),2),r=t[0],a=t[1];return Object(i.useEffect)((function(){0!=R.length?a({users:R,loading:!1}):_(e).then((function(e){R=e,a({users:e,loading:!1})}))}),[]),r}(t),a=r.users,n=r.loading,o=W(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object(i.useState)(e),r=G(t,2),a=r[0],n=r[1],o=function(e){var t=e.target;"studentsInput"===t.name||"staffInput"===t.name?c(t):n(q(q({},a),{},z({},t.name,t.value)))},c=function(e){var t=D(a[e.name]);e.checked?n(q(q({},a),{},z({},e.name,[].concat(D(t),[e.id])))):(t.splice(t.indexOf(e.id),1),n(q(q({},a),{},z({},e.name,t))))},s=function(e){e.preventDefault(),window.parent.parent.scrollTo(0,150),l()&&(n(q(q({},a),{},{status:"pending"})),T(a).then((function(e){var t=e.status,r=e.status_text;t?u(r):n(q(q({},a),{},{status:r}))})))},l=function(){var e=a.studentsInput,t=a.staffInput;return e.length+t.length!=0||(n(q(q({},a),{},{status:"empty-list"})),!1)},u=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"initialized";n(q(q({},e),{},{status:t}))};return[a,o,s]}({status:"initialized",subjectInput:"",messageInput:"",studentsInput:[],staffInput:[],courseId:t}),3),c=o[0],s=o[1],u=o[2],m=c.status,d=c.subjectInput,f=c.messageInput,p=c.studentsInput,v=c.staffInput;return l.a.createElement("div",{className:"rounded-lg shadow-lg py-4 px-5 my-2"},l.a.createElement("h3",null,"Formulario Nuevo Correo "),l.a.createElement(M.a,{onSubmit:u},l.a.createElement(M.a.Row,{className:"form-status"},l.a.createElement(H,{status:m})),l.a.createElement(M.a.Group,{controlId:"formGridSubject"},l.a.createElement(M.a.Label,{className:"lead"},"Asunto"),l.a.createElement(M.a.Control,{required:!0,placeholder:"Asunto del correo","aria-describedby":"subjectInput",name:"subjectInput",onChange:s,value:d})),l.a.createElement(M.a.Group,{controlId:"formGridMessage"},l.a.createElement(M.a.Label,{className:"lead"},"Mensaje"),l.a.createElement(M.a.Control,{required:!0,as:"textarea",placeholder:"Mensaje del correo","aria-describedby":"messageInput",name:"messageInput",onChange:s,value:f})),l.a.createElement("hr",null),l.a.createElement(M.a.Group,{id:"formGridCheckbox"}),l.a.createElement(M.a.Row,null,n&&l.a.createElement(g.a,{animation:"border",variant:"primary",className:"d-flex mx-auto mt-2 "}),l.a.createElement(M.a.Group,{as:B.a,controlId:"formGridReceiverStudent",className:"checkbox-group"},l.a.createElement(M.a.Label,{className:"lead"},"Destinatarios Estudiantes"),l.a.createElement("div",{className:"checkbox-input"},a.filter((function(e){return!e.has_role})).map((function(e){return l.a.createElement(M.a.Check,{type:"checkbox",className:"pl-0",name:"studentsInput",id:e.username,key:e.username,label:e.name,onChange:s,checked:p.includes(e.username)})})))),l.a.createElement(M.a.Group,{as:B.a,controlId:"formGridReceiverStaff",className:"checkbox-group"},l.a.createElement(M.a.Label,{className:"lead"},"Destinatarios Staff"),l.a.createElement("div",{className:"checkbox-input"},a.filter((function(e){return e.has_role})).map((function(e){return l.a.createElement(M.a.Check,{type:"checkbox",className:"pl-0",name:"staffInput",id:e.username,key:e.username,label:e.name,onChange:s,checked:v.includes(e.username)})}))))),l.a.createElement(M.a.Row,null,l.a.createElement(y.a,{variant:"outline-primary shadow-lg",size:"lg",type:"submit",className:"mx-auto",disabled:"pending"==m},l.a.createElement(w.a,{icon:x.faPaperPlane,className:"mr-2"})," Enviar Correo"))))};$.propTypes={courseId:E.a.string.isRequired};var U=r(514),V=r(214),K=r(513),Q=function(e){var t=e.email,r=e.modalState,a=e.setModalState,n=function(){return a(!1)},o=Object(i.useRef)(null);Object(i.useLayoutEffect)((function(){return window.parent.parent.scrollTo(0,o.current.modalBodyRef.current.offsetTop)}),[]);return l.a.createElement(K.a,{ref:o,open:r,title:"Detalle del correo",body:l.a.createElement("div",{className:"row px-2"},l.a.createElement("div",{className:"font-weight-bold col col-3 py-2"},"Fecha"),l.a.createElement("div",{className:"col col-9 py-2"},t.date),l.a.createElement("div",{className:"font-weight-bold col col-3 py-2"},"Enviado por"),l.a.createElement("div",{className:"col col-9 py-2"},t.sender),l.a.createElement("div",{className:"font-weight-bold col col-3 py-2"},"Asunto"),l.a.createElement("div",{className:"col col-9 py-2"},t.subject),l.a.createElement("div",{className:"font-weight-bold col col-3 py-2"},"Contenido"),l.a.createElement("div",{className:"text-justify col col-9 py-2"},t.message),t.receiver_users&&l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:"font-weight-bold col col-3 py-2"},"Destinatarios (",t.receiver_users.length,")"),l.a.createElement("div",{className:"text-justify col col-9 py-2"},l.a.createElement("ol",null,t.receiver_users.map((function(e){return l.a.createElement("li",{key:e},e)})))))),onClose:n,buttons:[l.a.createElement(y.a,{variant:"primary",onClick:n,"data-autofocus":!0},"Cerrar")],renderDefaultCloseButton:!1,dialogClassName:"modal-lg"})};function X(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e))&&"[object Arguments]"!==Object.prototype.toString.call(e))return;var r=[],a=!0,n=!1,o=void 0;try{for(var c,s=e[Symbol.iterator]();!(a=(c=s.next()).done)&&(r.push(c.value),!t||r.length!==t);a=!0);}catch(e){n=!0,o=e}finally{try{a||null==s.return||s.return()}finally{if(n)throw o}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}Q.propTypes={email:E.a.object.isRequired,modalState:E.a.bool.isRequired,setModalState:E.a.func.isRequired};var Y=function(e){var t=e.email,r=X(Object(i.useState)(!1),2),a=r[0],n=r[1];return l.a.createElement("div",{className:"row border-bottom"},l.a.createElement("div",{className:"col col-3 pt-2"},t.date),l.a.createElement("div",{className:"col col-3 pt-2"},t.sender),l.a.createElement("div",{className:"col col-5 pt-2"},t.subject),l.a.createElement("div",{className:"col col-1"},l.a.createElement(U.a,{icon:V.faInfo,alt:"Ver mayor información del correo",onClick:function(){return n(!0)},variant:"primary"})),a&&l.a.createElement(Q,{email:t,modalState:a,setModalState:n}))};Y.propTypes={email:E.a.object.isRequired};var Z=r(216),ee=function(e){var t=e.title;return l.a.createElement("div",{className:"text-center"},l.a.createElement(w.a,{icon:Z.faFrown,className:"h1"}),l.a.createElement("p",null,"Al parecer no tienes ",t.toLowerCase(),"."))};ee.propTypes={title:E.a.string.isRequired};var te,re,ae=function(e){var t=e.getEmails,r=e.title,a=function(e,t){var r=k(Object(i.useState)({data:[],loading:!0}),2),a=r[0],n=r[1];return Object(i.useEffect)((function(){n({data:[],loading:!0}),t(e).then((function(e){n({data:e,loading:!1})}))}),[t]),a}(e.courseId,t),n=a.data,o=a.loading;return l.a.createElement("div",{className:"rounded-lg shadow-lg py-4 px-5 my-2"},l.a.createElement("h3",null,r),o&&l.a.createElement(g.a,{animation:"border",variant:"primary",className:"d-flex mx-auto mt-2 "}),!o&&(0==n.length?l.a.createElement(ee,{title:r}):l.a.createElement("div",{className:"email-grid"},l.a.createElement("div",{className:"row font-weight-bold border-bottom py-2"},l.a.createElement("div",{className:"col col-3"},"Fecha"),l.a.createElement("div",{className:"col col-3"},"Enviado por"),l.a.createElement("div",{className:"col col-5"},"Asunto"),l.a.createElement("div",{className:"col col-1 text-center"},"Detalle")),n.map((function(e,t){return l.a.createElement(Y,{key:t,email:e})})))))};ae.propTypes={getEmails:E.a.func.isRequired,title:E.a.string.isRequired,courseId:E.a.string.isRequired};var ne=function(e){var t=e.type||"mutate",r=document.getElementById("content").offsetHeight,a=document.getElementById("content").offsetWidth;"load"!==t&&a===re&&r===te||(window.parent.postMessage({type:"plugin.resize",payload:{width:a,height:r}},document.referrer),te=r,re=a,window.scrollTo(0,0))};function oe(e,t,r,a,n,o,c){try{var s=e[o](c),i=s.value}catch(e){return void r(e)}s.done?t(i):Promise.resolve(i).then(a,n)}var ce=function(){var e,t=(e=regeneratorRuntime.mark((function e(t){var r,a,n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="/courses/".concat(t,"/course_emails/received"),e.next=3,fetch(r,{credentials:"same-origin"});case 3:if(200!=(a=e.sent).status){e.next=12;break}return e.next=7,a.json();case 7:return n=e.sent,o=n.map((function(e){return{subject:e.subject,message:e.message,sender:e.sender_user__profile__name,date:new Date(e.created_at.$date).toLocaleString("es-CL")}})),e.abrupt("return",o);case 12:return e.abrupt("return",[]);case 13:case"end":return e.stop()}}),e)})),function(){var t=this,r=arguments;return new Promise((function(a,n){var o=e.apply(t,r);function c(e){oe(o,a,n,c,s,"next",e)}function s(e){oe(o,a,n,c,s,"throw",e)}c(void 0)}))});return function(e){return t.apply(this,arguments)}}();function se(e,t,r,a,n,o,c){try{var s=e[o](c),i=s.value}catch(e){return void r(e)}s.done?t(i):Promise.resolve(i).then(a,n)}var ie=function(){var e,t=(e=regeneratorRuntime.mark((function e(t){var r,a,n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="/courses/".concat(t,"/course_emails/sended"),e.next=3,fetch(r,{credentials:"same-origin"});case 3:if(200!=(a=e.sent).status){e.next=12;break}return e.next=7,a.json();case 7:return n=e.sent,o=n.map((function(e){return{subject:e.subject,message:e.message,sender:e.sender_user,receiver_users:e.receiver_users_list,date:new Date(e.created_at.$date).toLocaleString("es-CL")}})),e.abrupt("return",o);case 12:return e.abrupt("return",[]);case 13:case"end":return e.stop()}}),e)})),function(){var t=this,r=arguments;return new Promise((function(a,n){var o=e.apply(t,r);function c(e){se(o,a,n,c,s,"next",e)}function s(e){se(o,a,n,c,s,"throw",e)}c(void 0)}))});return function(e){return t.apply(this,arguments)}}();function le(){Object(i.useEffect)((function(){return window!==window.parent&&(document.body.className+=" view-in-mfe",te=window.offsetHeight,re=window.offsetWidth,new MutationObserver(ne).observe(document.body,{attributes:!0,childList:!0,subtree:!0}),window.addEventListener("load",ne),window.addEventListener("resize",ne)),function(){window.removeEventListener("load",ne),window.removeEventListener("resize",ne)}}),[]);var e=window.location.hash.substring(1).split(/[\/]+/).pop();return l.a.createElement("div",{id:"content",className:"container"},l.a.createElement(v.a,null,l.a.createElement("div",null,l.a.createElement(A,{courseId:e}),l.a.createElement(b.c,null,l.a.createElement(b.a,{exact:!0,path:"/eol/eol_course_email/static/sended/"},l.a.createElement(ae,{getEmails:ie,title:"Correos Enviados",courseId:e})),l.a.createElement(b.a,{exact:!0,path:"/eol/eol_course_email/static/received/"},l.a.createElement(ae,{getEmails:ce,title:"Correos Recibidos",courseId:e})),l.a.createElement(b.a,{exact:!0,path:"/eol/eol_course_email/static/new/"},l.a.createElement($,{courseId:e})),l.a.createElement(b.a,{exact:!0,path:"/eol/eol_course_email/static/:courseId/"},l.a.createElement(ae,{getEmails:ce,title:"Correos Recibidos",courseId:e}))))))}r(466),r.p;Object(a.b)(n.h,(function(){m.a.render(l.a.createElement(c.a,null,l.a.createElement(le,null)),document.getElementById("root"))})),Object(a.b)(n.e,(function(e){m.a.render(l.a.createElement(s.a,{message:e.message}),document.getElementById("root"))})),Object(o.b)({messages:[p]})}},[[501,1,2]]]);
//# sourceMappingURL=app.2f6245f7a3a9790fabac.js.map